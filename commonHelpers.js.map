{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\nimport axios from 'axios';\n\nconst apiKey = '41862655-84ddc1d5da0620d7ed5964b7a';\n\nconst form = document.querySelector('.form');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst btnLoadMore = document.querySelector('.btn-load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    captionsData: 'alt',\n});\n\nbtnLoadMore.style.display = 'none';\nloader.style.display = 'none';\n\nlet currentPage = 1;\nlet cardHeight = 0;\n\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n\n    const searchQuery = event.currentTarget.elements.query.value.trim();\n    currentPage = 1;\n\n    try {\n        const { hits, totalHits } = await getImages(searchQuery, currentPage);\n\n        if (hits.length === 0) {\n            gallery.innerHTML = \"\";\n            iziToast.error({ position: 'topRight', message: 'Sorry, there are no images matching your search query. Please try again!' });\n            return;\n        }\n        \n        gallery.innerHTML = \"\";\n        \n        const markup = hits.map((hit) => {\n            return `<li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${hit.largeImageURL}\">\n                    <img\n                        class=\"gallery-image\"\n                        src=\"${hit.webformatURL}\"\n                        alt=\"${hit.tags}\"\n                    />\n                    <ul class=\"list\">\n                    <li><p class='list-item'>ğŸ’—Likes<span>${hit.likes}</span></p></li>\n                    <li><p class='list-item'>ğŸ‘ï¸Views<span>${hit.views}</span></p></li>\n                    <li><p class='list-item'>ğŸ’¬Comments<span>${hit.comments}</span></p></li>\n                    <li><p class='list-item'>ğŸ’ŒDownloads<span>${hit.downloads}</span></p></li>\n                    </ul>\n                </a>\n            </li>`;\n        }).join(\"\");\n\n        gallery.insertAdjacentHTML(`beforeend`, markup);\n        const oneImage = document.querySelector(\".gallery-item\");\n        form.reset();\n\n        if (oneImage) {\n            cardHeight = oneImage.getBoundingClientRect().height;\n        }\n        lightbox.refresh();\n\n        if (totalHits <= 40) {\n            btnLoadMore.style.display = 'none';\n        } else {\n            btnLoadMore.style.display = 'block';\n        }\n\n    } catch (error) {\n        iziToast.error({ position: 'topRight', message: 'Sorry, there are no images matching your search query. Please try again!' });\n    }\n});\n\n\n\n\nbtnLoadMore.addEventListener('click', async () => {\n    currentPage++;\n\n    try {\n        const searchQuery = form.elements.query.value.trim();\n        const result = await getImages(searchQuery, currentPage);\n\n        const markup = result.hits.map((hit) => {\n            return `<li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${hit.largeImageURL}\">\n                    <img\n                        class=\"gallery-image\"\n                        src=\"${hit.webformatURL}\"\n                        alt=\"${hit.tags}\"\n                    />\n                    <ul class=\"list\">\n                    <li><p class='list-item'>ğŸ’—Likes<span>${hit.likes}</span></p></li>\n                    <li><p class='list-item'>ğŸ‘ï¸Views<span>${hit.views}</span></p></li>\n                    <li><p class='list-item'>ğŸ’¬Comments<span>${hit.comments}</span></p></li>\n                    <li><p class='list-item'>ğŸ’ŒDownloads<span>${hit.downloads}</span></p></li>\n                    </ul>\n                </a>\n            </li>`;\n        }).join(\"\");\n\n        gallery.insertAdjacentHTML(`beforeend`, markup);\n        lightbox.refresh();\n        form.reset();\n\n        if (result.totalHits <= currentPage * 40) { \n            iziToast.info({\n                title: '',\n                message: 'We are sorry, but you have reached the end of search results.',\n            });\n            btnLoadMore.style.display = 'none';\n        }    \n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth'\n        });\n    } catch (error) {\n        iziToast.error({ position: 'topRight', message: 'Sorry, there are no images matching your search query. Please try again!' });\n    }\n});\n\nasync function getImages(param, page) {\n    loader.style.display = 'block';\n    try {\n        const response = await axios.get(`https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(param)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40`);\n        return {\n            hits: response.data.hits,\n            totalHits: response.data.totalHits\n        };\n    } catch (error) {\n        throw new Error(error.response.status);\n    } finally {\n        loader.style.display = 'none';\n        \n    }\n}"],"names":["apiKey","form","loader","gallery","btnLoadMore","lightbox","SimpleLightbox","currentPage","cardHeight","event","searchQuery","hits","totalHits","getImages","iziToast","markup","hit","oneImage","result","param","page","response","axios","error"],"mappings":"owBAIA,MAAMA,EAAS,qCAETC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,IACd,aAAc,KAClB,CAAC,EAEDF,EAAY,MAAM,QAAU,OAC5BF,EAAO,MAAM,QAAU,OAEvB,IAAIK,EAAc,EACdC,EAAa,EAGjBP,EAAK,iBAAiB,SAAU,MAAOQ,GAAU,CAC7CA,EAAM,eAAc,EAEpB,MAAMC,EAAcD,EAAM,cAAc,SAAS,MAAM,MAAM,OAC7DF,EAAc,EAEd,GAAI,CACA,KAAM,CAAE,KAAAI,EAAM,UAAAC,CAAW,EAAG,MAAMC,EAAUH,EAAaH,CAAW,EAEpE,GAAII,EAAK,SAAW,EAAG,CACnBR,EAAQ,UAAY,GACpBW,EAAS,MAAM,CAAE,SAAU,WAAY,QAAS,0EAA0E,CAAE,EAC5H,MACH,CAEDX,EAAQ,UAAY,GAEpB,MAAMY,EAASJ,EAAK,IAAKK,GACd;AAAA,gDAC6BA,EAAI;AAAA;AAAA;AAAA,+BAGrBA,EAAI;AAAA,+BACJA,EAAI;AAAA;AAAA;AAAA,4DAGyBA,EAAI;AAAA,6DACHA,EAAI;AAAA,+DACFA,EAAI;AAAA,gEACHA,EAAI;AAAA;AAAA;AAAA,kBAI3D,EAAE,KAAK,EAAE,EAEVb,EAAQ,mBAAmB,YAAaY,CAAM,EAC9C,MAAME,EAAW,SAAS,cAAc,eAAe,EACvDhB,EAAK,MAAK,EAENgB,IACAT,EAAaS,EAAS,sBAAuB,EAAC,QAElDZ,EAAS,QAAO,EAEZO,GAAa,GACbR,EAAY,MAAM,QAAU,OAE5BA,EAAY,MAAM,QAAU,OAGnC,MAAC,CACEU,EAAS,MAAM,CAAE,SAAU,WAAY,QAAS,0EAA0E,CAAE,CAC/H,CACL,CAAC,EAKDV,EAAY,iBAAiB,QAAS,SAAY,CAC9CG,IAEA,GAAI,CACA,MAAMG,EAAcT,EAAK,SAAS,MAAM,MAAM,OACxCiB,EAAS,MAAML,EAAUH,EAAaH,CAAW,EAEjDQ,EAASG,EAAO,KAAK,IAAKF,GACrB;AAAA,gDAC6BA,EAAI;AAAA;AAAA;AAAA,+BAGrBA,EAAI;AAAA,+BACJA,EAAI;AAAA;AAAA;AAAA,4DAGyBA,EAAI;AAAA,6DACHA,EAAI;AAAA,+DACFA,EAAI;AAAA,gEACHA,EAAI;AAAA;AAAA;AAAA,kBAI3D,EAAE,KAAK,EAAE,EAEVb,EAAQ,mBAAmB,YAAaY,CAAM,EAC9CV,EAAS,QAAO,EAChBJ,EAAK,MAAK,EAENiB,EAAO,WAAaX,EAAc,KAClCO,EAAS,KAAK,CACV,MAAO,GACP,QAAS,+DACzB,CAAa,EACDV,EAAY,MAAM,QAAU,QAEhC,OAAO,SAAS,CACZ,IAAKI,EAAa,EAClB,SAAU,QACtB,CAAS,CACJ,MAAC,CACEM,EAAS,MAAM,CAAE,SAAU,WAAY,QAAS,0EAA0E,CAAE,CAC/H,CACL,CAAC,EAED,eAAeD,EAAUM,EAAOC,EAAM,CAClClB,EAAO,MAAM,QAAU,QACvB,GAAI,CACA,MAAMmB,EAAW,MAAMC,EAAM,IAAI,gCAAgCtB,OAAY,mBAAmBmB,CAAK,kEAAkEC,eAAkB,EACzL,MAAO,CACH,KAAMC,EAAS,KAAK,KACpB,UAAWA,EAAS,KAAK,SACrC,CACK,OAAQE,EAAP,CACE,MAAM,IAAI,MAAMA,EAAM,SAAS,MAAM,CAC7C,QAAc,CACNrB,EAAO,MAAM,QAAU,MAE1B,CACL"}